/**
 * betsol-ng-ui-router-styles - Load custom CSS for different routes
 * @version v0.0.1
 * @link https://github.com/betsol/ng-ui-router-styles
 * @license MIT
 *
 * @author Slava Fomin II <s.fomin@betsol.ru>
 */
!function(t,e){"use strict";function n(e){"string"==typeof e&&(e=[e]);var n={};return t.forEach(e,function(t,e){if("string"==typeof t)t={url:t};else if("object"==typeof t){if(!t.url)return void u("state style definition must have URL specified");t.id&&(e=t.id)}o(e)&&(e=r()),t.id=e,n[e]=t}),n}function o(t){return Number(t)===t&&t%1===0}function r(){return"@resource~"+f++}function u(t){console.log("betsol-ng-ui-router-styles: "+t)}function i(t){var n=a.defer();if(e.loadStylesheet){var o=e.loadStylesheet(t.url,function(){n.resolve()});l.push(o)}else u("betsol-load-stylesheet module must be loaded"),n.reject();return n.promise}function s(){t.forEach(l,function(t){t.remove()}),l=[]}var a,c="stylesLoaded",f=1,l=[];t.module("betsol.uiRouterStyles",["ui.router"]).config(["$stateProvider",function(t){t.decorator("data",function(t,e){var o=e(t);return"undefined"!=typeof o.css&&(o.css=n(o.css)),o})}]).run(["$rootScope","$state","$injector",function(e,n,o){a=o.get("$q"),e.$on("$stateChangeStart",function(o,r,u,f,l){var d=[],v=r;do d.unshift(v),v=v.parent?n.get(v.parent):null;while(v);var h={};t.forEach(d,function(e){e.data&&e.data.css&&t.extend(h,e.data.css)}),s();var p=[];t.forEach(h,function(t){p.push(i(t))}),a.all(p).then(function(){e.$broadcast(c)})})}]).provider("uiRouterStyles",function(){var t={},e={$get:function(){return t}};return e})}(angular,window);